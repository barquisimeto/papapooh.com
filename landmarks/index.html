<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wonder Hunter - Ultimate Edition</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; background-color: #1e1b4b; overflow: hidden; font-family: sans-serif; }
        #game-container { position: relative; width: 100vw; height: 100vh; background: #312e81; border: 0px solid #fbbf24; transition: border-width 0.1s, box-shadow 0.1s; }
        #map-svg { width: 100%; height: 100%; cursor: grab; }
        #map-svg:active { cursor: grabbing; }
        .country-path { stroke: #4338ca; stroke-width: 0.5px; fill: #1e1b4b; pointer-events: none; }
        .landmark-point { cursor: pointer; transition: all 0.3s; fill: #fbbf24; stroke: #fff; stroke-width: 2px; }
        .landmark-point:hover { fill: #fcd34d; r: 14; }
        .hud { position: absolute; z-index: 10; pointer-events: none; }
        .hud-content { pointer-events: auto; background: rgba(30, 27, 75, 0.95); backdrop-filter: blur(10px); border: 2px solid #6366f1; border-radius: 1.5rem; box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.7); }
        #tooltip { position: absolute; opacity: 0; pointer-events: none; background: #fbbf24; color: #1e1b4b; padding: 5px 12px; border-radius: 8px; font-size: 16px; font-weight: 900; z-index: 100; }
        .pulse-button { animation: pulse 2s infinite; }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } }
        #target-img { width: 100%; height: 150px; object-fit: cover; border-radius: 1rem; margin-top: 1rem; border: 2px solid #6366f1; }
    </style>
</head>
<body>

    <div id="game-container">
        <div id="start-screen" class="fixed inset-0 z-50 bg-indigo-950 flex flex-col items-center justify-center p-6 text-center">
            <h1 class="text-7xl font-black mb-6 text-transparent bg-clip-text bg-gradient-to-r from-yellow-400 to-orange-500 uppercase tracking-tighter">WONDER HUNTER</h1>
            <p id="loading-voice-text" class="text-2xl mb-10 text-indigo-200 animate-pulse font-bold">Warming up the explorer engines...</p>
            <button id="start-btn" class="hidden bg-yellow-500 hover:bg-yellow-600 text-indigo-900 font-black py-6 px-16 rounded-full text-4xl shadow-2xl transition-all hover:scale-110">START HUNTING</button>
        </div>

        <div id="winner-screen" class="hidden fixed inset-0 z-50 bg-indigo-900/98 flex flex-col items-center justify-center p-6 text-center">
            <div class="text-9xl mb-6">üó∫Ô∏è</div>
            <h1 id="winner-text" class="text-8xl font-black mb-4 text-white uppercase"></h1>
            <button onclick="location.reload()" class="mt-10 bg-white text-indigo-900 font-black py-4 px-12 rounded-full text-3xl shadow-2xl">PLAY AGAIN</button>
        </div>

        <div class="hud top-4 left-4">
            <div class="hud-content p-4 flex gap-10">
                <div id="box-Alani" class="text-center transition-all"><p class="text-xs font-black text-emerald-400 uppercase">ALANI üéæ</p><p id="score-Alani" class="text-5xl font-mono font-bold text-white">0</p></div>
                <div class="w-px bg-indigo-800 h-16"></div>
                <div id="box-Wilder" class="text-center opacity-50 transition-all"><p class="text-xs font-black text-cyan-400 uppercase">WILDER üéÆ</p><p id="score-Wilder" class="text-5xl font-mono font-bold text-white">0</p></div>
            </div>
        </div>

        <div class="hud top-4 right-4 text-right">
            <div class="hud-content p-6 border-4 border-yellow-500 min-w-[350px] max-w-[400px]">
                <p id="turn-label" class="text-yellow-400 text-lg font-black uppercase mb-2"></p>
                <p class="text-indigo-300 text-xs uppercase font-black tracking-widest">Find this Wonder:</p>
                <h2 id="target-landmark" class="text-3xl font-black text-white leading-tight mt-1">---</h2>
                <img id="target-img" src="" alt="Landmark Preview" style="display:none;">
            </div>
        </div>

        <div class="hud top-1/2 left-4 -translate-y-1/2">
            <button onclick="papaEncourage()" class="hud-content pulse-button p-5 flex flex-col items-center gap-3 border-yellow-400 border-4 bg-indigo-900 shadow-2xl">
                <span class="text-6xl">üë¥</span>
                <p class="text-yellow-400 font-black text-sm uppercase tracking-widest">Ask Papa!</p>
            </button>
        </div>

        <svg id="map-svg"></svg>
        <div id="tooltip"></div>
    </div>

    <script>
        const players = ['Alani', 'Wilder'];
        let currentPlayer = 'Alani';
        let scores = { Alani: 0, Wilder: 0 };
        let targetLandmark = null;
        let preferredVoice = null;
        let voiceReady = false;

        const landmarks = [
            // --- THE COMPLETE RESTORED LIST ---
            { name: "Pyramids of Egypt", location: "Cairo, Egypt", coords: [31.13, 29.97], fact: "The Great Pyramid was the tallest thing on Earth for 4,000 years!", img: "https://images.unsplash.com/photo-1503177119275-0aa32b3a9368?w=500&q=80" },
            { name: "Nile River", location: "Africa", coords: [31.13, 30.0], fact: "The longest river in the world! It helped the ancient Egyptians build the pyramids!", img: "https://images.unsplash.com/photo-1546271876-af6caec5fae5?w=500&q=80" },
            { name: "Taj Mahal", location: "Agra, India", coords: [78.04, 27.17], fact: "This beautiful palace was built for love! It's India's greatest treasure!", img: "https://images.unsplash.com/photo-1564507592333-c60657eaa0ae?w=500&q=80" },
            { name: "Indian Ocean", location: "the Southern Hemisphere", coords: [80.0, -10.0], fact: "Your special ocean! It's the warmest ocean in the world!", img: "https://images.unsplash.com/photo-1589988096692-2ba67a88542a?w=500&q=80" },
            { name: "Eiffel Tower", location: "Paris, France", coords: [2.29, 48.85], fact: "The Eiffel Tower grows 6 inches every summer! It loves the sun!", img: "https://images.unsplash.com/photo-1511739001486-6bfe10ce785f?w=500&q=80" },
            { name: "Kennedy Space Center", location: "Florida, USA", coords: [-80.67, 28.52], fact: "Rockets blast off to the stars from right here in Florida!", img: "https://images.unsplash.com/photo-1517976487492-5750f3195933?w=500&q=80" },
            { name: "Grand Canyon", location: "Arizona, USA", coords: [-112.11, 36.10], fact: "A hole so big you can see it from the moon!", img: "https://images.unsplash.com/photo-1474044159687-1ee9f3a51722?w=500&q=80" },
            { name: "Machu Picchu", location: "Peru", coords: [-72.54, -13.16], fact: "A city high in the clouds! Built by the Incas a long time ago!", img: "https://images.unsplash.com/photo-1587593810167-a84920ea0781?w=500&q=80" },
            { name: "The Colosseum", location: "Rome, Italy", coords: [12.49, 41.89], fact: "Ancient gladiators used to play games here in the world's oldest stadium!", img: "https://images.unsplash.com/photo-1552832230-c0197dd311b5?w=500&q=80" },
            { name: "Great Wall of China", location: "China", coords: [116.57, 40.43], fact: "Sticky rice was used as mortar to hold the bricks together!", img: "https://images.unsplash.com/photo-1508804185872-d7badad00f7d?w=500&q=80" },
            { name: "Amazon River", location: "South America", coords: [-60.0, -3.0], fact: "The biggest river on Earth! It has pink dolphins and toothy piranhas!", img: "https://images.unsplash.com/photo-1451187580459-43490279c0fa?w=500&q=80" },
            { name: "Sydney Opera House", location: "Australia", coords: [151.21, -33.85], fact: "It looks like giant white sails on the ocean!", img: "https://images.unsplash.com/photo-1506973035872-a4ec16b8e8d9?w=500&q=80" }
        ];

        function initVoices() {
            const voices = window.speechSynthesis.getVoices();
            if (voices.length > 0 && !voiceReady) {
                preferredVoice = voices.find(v => v.name.includes('Female') || v.name.includes('Google US English') || v.name.includes('Samantha'));
                document.getElementById('loading-voice-text').innerText = "All wonders restored! Ready Alani and Wilder?";
                document.getElementById('start-btn').classList.remove('hidden');
                voiceReady = true;
            }
        }
        window.speechSynthesis.onvoiceschanged = initVoices;
        setTimeout(initVoices, 500);

        function speak(text, onEnd) {
            window.speechSynthesis.cancel();
            const u = new SpeechSynthesisUtterance(text);
            if (preferredVoice) u.voice = preferredVoice;
            u.pitch = 1.2; u.rate = 0.95;
            let triggered = false;
            u.onend = () => { if(!triggered) { triggered = true; if(onEnd) onEnd(); }};
            setTimeout(() => { if(!triggered) { triggered = true; if(onEnd) onEnd(); }}, text.length * 100);
            window.speechSynthesis.speak(u);
        }

        const svg = d3.select("#map-svg");
        const g = svg.append("g");
        const projection = d3.geoNaturalEarth1().scale(window.innerWidth / 5.5).translate([window.innerWidth / 2, window.innerHeight / 1.7]);
        const path = d3.geoPath().projection(projection);

        svg.call(d3.zoom().scaleExtent([1, 15]).on("zoom", (e) => g.attr("transform", e.transform)));

        d3.json("https://raw.githubusercontent.com/datasets/geo-countries/master/data/countries.geojson").then(data => {
            g.selectAll("path").data(data.features).enter().append("path").attr("d", path).attr("class", "country-path");
            drawLandmarks();
        });

        // PROXIMITY TRACKER
        svg.on("mousemove", function(event) {
            if (!targetLandmark) return;
            const [mx, my] = d3.pointer(event, g.node());
            const [tx, ty] = projection(targetLandmark.coords);
            const dist = Math.sqrt((mx - tx)**2 + (my - ty)**2);
            const intensity = Math.max(0, 10 - (dist / 100));
            const container = document.getElementById("game-container");
            container.style.borderWidth = (intensity * 2) + "px";
            container.style.boxShadow = `inset 0 0 ${intensity * 15}px #fbbf24`;
        });

        function drawLandmarks() {
            g.selectAll(".landmark-point").data(landmarks).enter().append("circle")
                .attr("class", "landmark-point")
                .attr("cx", d => projection(d.coords)[0])
                .attr("cy", d => projection(d.coords)[1])
                .attr("r", 10)
                .on("mouseover", function(event, d) {
                    d3.select("#tooltip").style("opacity", 1).html("???").style("left", (event.pageX + 15) + "px").style("top", (event.pageY - 20) + "px");
                })
                .on("mouseout", () => d3.select("#tooltip").style("opacity", 0))
                .on("click", (e, d) => handleLandmarkClick(d));
        }

        document.getElementById('start-btn').onclick = () => {
            document.getElementById('start-screen').classList.add('hidden');
            speak("Welcome hunters! Find the wonder! If you miss, you lose your turn!", nextRound);
        };

        function nextRound() {
            if (scores.Alani >= 1000 || scores.Wilder >= 1000) { endGame(); return; }
            targetLandmark = landmarks[Math.floor(Math.random() * landmarks.length)];
            const fullText = targetLandmark.name + " in " + targetLandmark.location;
            const img = document.getElementById('target-img');
            img.src = targetLandmark.img;
            img.style.display = "block";
            document.getElementById('target-landmark').innerText = fullText;
            document.getElementById('turn-label').innerText = currentPlayer + "'s Turn";
            document.getElementById('box-Alani').style.opacity = (currentPlayer === 'Alani' ? "1" : "0.3");
            document.getElementById('box-Wilder').style.opacity = (currentPlayer === 'Wilder' ? "1" : "0.3");
            speak(currentPlayer + ", find the " + targetLandmark.name);
        }

        function handleLandmarkClick(d) {
            if (d.name === targetLandmark.name) {
                scores[currentPlayer] += 200;
                document.getElementById('score-' + currentPlayer).innerText = scores[currentPlayer];
                speak("Bingo! " + d.fact, () => {
                    currentPlayer = (currentPlayer === 'Alani' ? 'Wilder' : 'Alani');
                    speak("Now it's " + currentPlayer + "'s turn", nextRound);
                });
            } else {
                speak("Not quite! Turn missed!", () => {
                    currentPlayer = (currentPlayer === 'Alani' ? 'Wilder' : 'Alani');
                    speak("Now it's " + currentPlayer + "'s turn", nextRound);
                });
            }
        }

        function papaEncourage() {
            speak("Papa Pooh says: Watch the yellow border glow! It gets brightest when you are right on top of the wonder!");
        }

        function endGame() {
            const winner = (scores.Alani >= 1000 ? 'Alani' : 'Wilder');
            document.getElementById('winner-text').innerText = winner + " Wins!";
            document.getElementById('winner-screen').classList.remove('hidden');
            speak("Hooray! Congratulations " + winner + "! Master explorer!");
        }
    </script>
</body>
</html>
