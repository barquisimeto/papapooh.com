<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI World Geography - Papa Pooh Edition</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; background-color: #0f172a; overflow: hidden; font-family: sans-serif; }
        #game-container { position: relative; width: 100vw; height: 100vh; background: #1e293b; }
        #map-svg { width: 100%; height: 100%; }
        .country-path { stroke: #94a3b8; stroke-width: 0.5px; cursor: pointer; transition: fill 0.2s; fill: #334155; }
        .country-path:hover { fill: #64748b !important; }
        .hud { position: absolute; z-index: 10; pointer-events: none; }
        .hud-content { pointer-events: auto; background: rgba(15, 23, 42, 0.9); backdrop-filter: blur(10px); border: 1px solid #334155; border-radius: 1.5rem; box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.5); }
        #tooltip { position: absolute; opacity: 0; pointer-events: none; background: #0f172a; color: white; padding: 5px 12px; border-radius: 8px; border: 2px solid #22d3ee; font-size: 16px; font-weight: bold; z-index: 100; }
        .pulse-button { animation: pulse 2s infinite; }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }
    </style>
</head>
<body>

    <div id="game-container">
        <div id="start-screen" class="fixed inset-0 z-50 bg-slate-900 flex flex-col items-center justify-center p-6 text-center">
            <h1 class="text-6xl font-black mb-6 text-transparent bg-clip-text bg-gradient-to-r from-emerald-400 to-cyan-400 uppercase tracking-tight">World Explorer</h1>
            <p class="text-2xl mb-10 max-w-lg text-slate-300 font-medium">Alani and Wilder, get ready for a global adventure! First to 1000 points wins!</p>
            <button id="start-btn" class="bg-emerald-500 hover:bg-emerald-600 text-white font-bold py-6 px-16 rounded-full text-4xl shadow-2xl transition-all hover:scale-110">START ADVENTURE</button>
        </div>

        <div id="winner-screen" class="hidden fixed inset-0 z-50 bg-emerald-900/98 flex flex-col items-center justify-center p-6 text-center">
            <div class="text-9xl mb-6">üèÜ</div>
            <h1 id="winner-text" class="text-8xl font-black mb-4 text-white uppercase"></h1>
            <p class="text-2xl mb-10 text-emerald-100">You've conquered the globe! Papa Pooh is proud!</p>
            <button onclick="location.reload()" class="bg-white text-emerald-900 font-black py-4 px-12 rounded-full text-3xl shadow-2xl">PLAY AGAIN</button>
        </div>

        <div class="hud top-4 left-4">
            <div class="hud-content p-4 flex gap-8">
                <div id="box-Alani" class="text-center transition-opacity"><p class="text-[10px] font-black text-emerald-400 uppercase tracking-tighter">ALANI</p><p id="score-Alani" class="text-4xl font-mono font-bold text-white">0</p></div>
                <div class="w-px bg-slate-700 h-12"></div>
                <div id="box-Wilder" class="text-center opacity-50 transition-opacity"><p class="text-[10px] font-black text-cyan-400 uppercase tracking-tighter">WILDER</p><p id="score-Wilder" class="text-4xl font-mono font-bold text-white">0</p></div>
            </div>
        </div>

        <div class="hud top-4 right-4 text-right">
            <div class="hud-content p-6 border-2 border-cyan-500/50 min-w-[300px]">
                <p id="turn-label" class="text-cyan-400 text-sm font-black uppercase mb-1"></p>
                <p class="text-slate-500 text-xs uppercase font-bold">Find this country:</p>
                <h2 id="target-country" class="text-5xl font-black text-white leading-tight">---</h2>
                <p id="hint-text" class="text-amber-300 text-sm font-bold italic mt-4 hidden bg-amber-900/40 p-3 rounded-xl border border-amber-500/30">üí° Hint: Look in the bright blue area!</p>
            </div>
        </div>

        <div id="papa-helper" class="hud top-1/2 left-4 hidden">
            <button onclick="papaEncourage()" class="hud-content pulse-button p-4 flex flex-col items-center gap-2 border-emerald-400 border-2">
                <span class="text-4xl">üë¥</span>
                <p class="text-emerald-400 font-black text-[10px] uppercase">Papa's Help!</p>
            </button>
        </div>

        <div id="fact-container" class="hud bottom-8 left-8 opacity-0 transition-opacity duration-500 max-w-md">
            <div class="hud-content border-emerald-500/50 p-6">
                <div class="flex items-center gap-3 mb-2"><span class="text-2xl">ü§ñ</span><h4 class="text-emerald-400 font-black text-xs uppercase tracking-widest">Gemini AI Fact</h4></div>
                <p id="fact-text" class="text-lg text-slate-100 leading-snug font-medium italic"></p>
            </div>
        </div>

        <svg id="map-svg"></svg>
        <div id="tooltip"></div>
    </div>

    <script>
        const players = ['Alani', 'Wilder'];
        let currentPlayer = 'Alani';
        let scores = { Alani: 0, Wilder: 0 };
        let targetCountry = null;
        let countriesData = [];
        let currentContinent = "";

        const funnyFacts = {
            "Canada": "Canada has more lakes than the rest of the world combined. That's a lot of fish farts!",
            "Brazil": "Brazil has over 4,000 airports. Some runways are basically just flat grass for jungle pilots!",
            "Australia": "Australia has a fence longer than the width of the entire United Kingdom. It keeps dingoes away!",
            "Italy": "In Italy, some people believe it's bad luck to put bread upside down on the table. No messy sandwiches allowed!",
            "Japan": "Japan has over 5 million vending machines. You can buy hot coffee or even fresh eggs from a machine!",
            "France": "In France, the most eaten food is bread. They eat 10 billion baguettes a year. Crunch crunch!",
            "China": "China uses 45 billion pairs of chopsticks every year. That's a mountain of wood!",
            "United States of America": "The USA has enough gold in Fort Knox to pave a road to the moon... maybe!",
            "Russia": "Russia has a museum just for cats! The cats are the guards and they live in the basement!",
            "Egypt": "The ancient Egyptians loved cats so much they would shave off their eyebrows when their pet cat died!",
            "Portugal": "Portugal has a bridge so long you can't see the other side! It's like a road over the infinite ocean!",
            "Switzerland": "Switzerland has a mountain peak named 'The Chocolate Mountain' because it looks like a giant Toblerone!",
            "Mexico": "The first chocolate bar was made in Mexico! Without them, we'd have no brownies!",
            "Iceland": "Iceland doesn't have a single McDonald's. They prefer their own magical Viking burgers!",
            "Norway": "Norway has a secret underground vault filled with every kind of seed in the world, just in case of a zombie attack!",
            "Madagascar": "Madagascar has trees called Baobabs that look like they were planted upside down with roots in the air!"
        };

        const sillyCompliments = [
            "You have the eyes of an eagle!",
            "Are you a professional explorer? Because that was perfect!",
            "Wow! You found that faster than a cheetah!",
            "Unbelievable! You're a geography superstar!",
            "Kaboom! You are on fire!"
        ];

        const continentsMap = {
            "Canada": "North America", "United States of America": "North America", "Mexico": "North America",
            "Brazil": "South America", "Argentina": "South America", "Chile": "South America",
            "France": "Europe", "Italy": "Europe", "Germany": "Europe", "Spain": "Europe", "United Kingdom": "Europe", "Portugal": "Europe", "Switzerland": "Europe", "Norway": "Europe", "Iceland": "Europe",
            "China": "Asia", "India": "Asia", "Japan": "Asia", "Thailand": "Asia", "Russia": "Asia",
            "Egypt": "Africa", "South Africa": "Africa", "Nigeria": "Africa", "Kenya": "Africa", "Madagascar": "Africa",
            "Australia": "Oceania", "New Zealand": "Oceania"
        };

        function speak(text, onEnd) {
            window.speechSynthesis.cancel();
            const utterance = new SpeechSynthesisUtterance(text);
            const voices = window.speechSynthesis.getVoices();
            const preferredVoice = voices.find(v => v.name.includes('Female') || v.name.includes('Google US English') || v.name.includes('Samantha') || v.name.includes('Zira'));
            if (preferredVoice) utterance.voice = preferredVoice;
            utterance.pitch = 1.2; utterance.rate = 0.95;
            utterance.onend = onEnd;
            window.speechSynthesis.speak(utterance);
        }

        function papaEncourage() {
            const lines = [
                "Don't worry Alani and Wilder, you're doing great! Keep looking!",
                "Papa Pooh says: The world is big, but you're a giant explorer! Try again!",
                "You're almost there! Use your explorer eyes and find that country!"
            ];
            speak(lines[Math.floor(Math.random() * lines.length)]);
            document.getElementById('papa-helper').classList.add('hidden');
        }

        window.speechSynthesis.onvoiceschanged = () => window.speechSynthesis.getVoices();

        const svg = d3.select("#map-svg");
        const g = svg.append("g");
        const projection = d3.geoMercator().scale(window.innerWidth / 6.5).translate([window.innerWidth / 2, window.innerHeight / 1.5]);
        const path = d3.geoPath().projection(projection);

        svg.call(d3.zoom().scaleExtent([1, 15]).on("zoom", (e) => g.attr("transform", e.transform)));

        d3.json("https://raw.githubusercontent.com/datasets/geo-countries/master/data/countries.geojson").then(data => {
            countriesData = data.features;
            g.selectAll("path").data(countriesData).enter().append("path")
                .attr("d", path).attr("class", "country-path")
                .on("mouseover", function(event, d) {
                    const name = d.properties.ADMIN || d.properties.name || d.properties.name_en;
                    d3.select("#tooltip").style("opacity", 1).html(name).style("left", (event.pageX + 15) + "px").style("top", (event.pageY - 20) + "px");
                    d3.select(this).style("stroke", "#fff").style("stroke-width", "2.5px");
                })
                .on("mouseout", function() {
                    d3.select("#tooltip").style("opacity", 0);
                    d3.select(this).style("stroke", "#94a3b8").style("stroke-width", "0.5px");
                })
                .on("click", (e, d) => {
                    const name = d.properties.ADMIN || d.properties.name || d.properties.name_en;
                    handleCountryClick(name);
                });
        });

        document.getElementById('start-btn').onclick = () => {
            document.getElementById('start-screen').classList.add('hidden');
            speak("Hi Alani and Wilder! Let's explore the world with Papa Pooh! First to 1000 points wins. Alani, find the first country!", nextRound);
        };

        function nextRound() {
            if (scores.Alani >= 1000 || scores.Wilder >= 1000) { endGame(); return; }
            const list = Object.keys(continentsMap);
            targetCountry = list[Math.floor(Math.random() * list.length)];
            currentContinent = continentsMap[targetCountry];
            document.getElementById('target-country').innerText = targetCountry;
            document.getElementById('turn-label').innerText = currentPlayer + "'s Turn";
            document.getElementById('fact-container').style.opacity = "0";
            document.getElementById('box-Alani').style.opacity = (currentPlayer === 'Alani' ? "1" : "0.3");
            document.getElementById('box-Wilder').style.opacity = (currentPlayer === 'Wilder' ? "1" : "0.3");
            const hint = document.getElementById('hint-text');
            if (currentPlayer === 'Wilder') {
                hint.innerText = "üí° Hint: It's in " + currentContinent;
                hint.classList.remove('hidden');
            } else { hint.classList.add('hidden'); }
            g.selectAll("path").transition().duration(500).style("fill", d => {
                const n = d.properties.ADMIN || d.properties.name;
                if (currentPlayer === 'Wilder' && continentsMap[n] === currentContinent) return "#0ea5e9";
                return "#334155";
            });
        }

        function handleCountryClick(name) {
            if (name === targetCountry) {
                document.getElementById('papa-helper').classList.add('hidden');
                scores[currentPlayer] += 200;
                document.getElementById('score-' + currentPlayer).innerText = scores[currentPlayer];
                const compliment = sillyCompliments[Math.floor(Math.random() * sillyCompliments.length)];
                const fact = funnyFacts[name] || "This country has some of the world's best ice cream!";
                document.getElementById('fact-text').innerText = fact;
                document.getElementById('fact-container').style.opacity = "1";
                speak(compliment + " " + fact, () => { switchPlayer(); });
            } else {
                document.getElementById('papa-helper').classList.remove('hidden');
                speak("Not quite! That was " + name + ". Keep going!", () => { switchPlayer(); });
            }
        }

        function switchPlayer() {
            currentPlayer = currentPlayer === 'Alani' ? 'Wilder' : 'Alani';
            speak("Now it is " + currentPlayer + "'s turn.", nextRound);
        }

        function endGame() {
            const winner = scores.Alani >= 1000 ? 'Alani' : 'Wilder';
            document.getElementById('winner-text').innerText = winner + " Wins!";
            document.getElementById('winner-screen').classList.remove('hidden');
            speak("Congratulations " + winner + "! You are the world explorer champion! Papa Pooh is so proud of you both!");
        }
    </script>
</body>
</html>
